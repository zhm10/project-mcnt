{"ast":null,"code":"/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\n\"use strict\";\n\nconst HarmonyAcceptDependency = require(\"./HarmonyAcceptDependency\");\nconst HarmonyAcceptImportDependency = require(\"./HarmonyAcceptImportDependency\");\nconst HarmonyCompatibilityDependency = require(\"./HarmonyCompatibilityDependency\");\nconst HarmonyEvaluatedImportSpecifierDependency = require(\"./HarmonyEvaluatedImportSpecifierDependency\");\nconst HarmonyExportExpressionDependency = require(\"./HarmonyExportExpressionDependency\");\nconst HarmonyExportHeaderDependency = require(\"./HarmonyExportHeaderDependency\");\nconst HarmonyExportImportedSpecifierDependency = require(\"./HarmonyExportImportedSpecifierDependency\");\nconst HarmonyExportSpecifierDependency = require(\"./HarmonyExportSpecifierDependency\");\nconst HarmonyImportSideEffectDependency = require(\"./HarmonyImportSideEffectDependency\");\nconst HarmonyImportSpecifierDependency = require(\"./HarmonyImportSpecifierDependency\");\nconst {\n  JAVASCRIPT_MODULE_TYPE_AUTO,\n  JAVASCRIPT_MODULE_TYPE_ESM\n} = require(\"../ModuleTypeConstants\");\nconst HarmonyDetectionParserPlugin = require(\"./HarmonyDetectionParserPlugin\");\nconst HarmonyExportDependencyParserPlugin = require(\"./HarmonyExportDependencyParserPlugin\");\nconst HarmonyImportDependencyParserPlugin = require(\"./HarmonyImportDependencyParserPlugin\");\nconst HarmonyTopLevelThisParserPlugin = require(\"./HarmonyTopLevelThisParserPlugin\");\n\n/** @typedef {import(\"../../declarations/WebpackOptions\").JavascriptParserOptions} JavascriptParserOptions */\n/** @typedef {import(\"../Compiler\")} Compiler */\n/** @typedef {import(\"../javascript/JavascriptParser\")} Parser */\n\nconst PLUGIN_NAME = \"HarmonyModulesPlugin\";\n\n/** @typedef {{ topLevelAwait?: boolean }} HarmonyModulesPluginOptions */\n\nclass HarmonyModulesPlugin {\n  /**\n   * @param {HarmonyModulesPluginOptions} options options\n   */\n  constructor(options) {\n    this.options = options;\n  }\n\n  /**\n   * Apply the plugin\n   * @param {Compiler} compiler the compiler instance\n   * @returns {void}\n   */\n  apply(compiler) {\n    compiler.hooks.compilation.tap(PLUGIN_NAME, (compilation, {\n      normalModuleFactory\n    }) => {\n      compilation.dependencyTemplates.set(HarmonyCompatibilityDependency, new HarmonyCompatibilityDependency.Template());\n      compilation.dependencyFactories.set(HarmonyImportSideEffectDependency, normalModuleFactory);\n      compilation.dependencyTemplates.set(HarmonyImportSideEffectDependency, new HarmonyImportSideEffectDependency.Template());\n      compilation.dependencyFactories.set(HarmonyImportSpecifierDependency, normalModuleFactory);\n      compilation.dependencyTemplates.set(HarmonyImportSpecifierDependency, new HarmonyImportSpecifierDependency.Template());\n      compilation.dependencyFactories.set(HarmonyEvaluatedImportSpecifierDependency, normalModuleFactory);\n      compilation.dependencyTemplates.set(HarmonyEvaluatedImportSpecifierDependency, new HarmonyEvaluatedImportSpecifierDependency.Template());\n      compilation.dependencyTemplates.set(HarmonyExportHeaderDependency, new HarmonyExportHeaderDependency.Template());\n      compilation.dependencyTemplates.set(HarmonyExportExpressionDependency, new HarmonyExportExpressionDependency.Template());\n      compilation.dependencyTemplates.set(HarmonyExportSpecifierDependency, new HarmonyExportSpecifierDependency.Template());\n      compilation.dependencyFactories.set(HarmonyExportImportedSpecifierDependency, normalModuleFactory);\n      compilation.dependencyTemplates.set(HarmonyExportImportedSpecifierDependency, new HarmonyExportImportedSpecifierDependency.Template());\n      compilation.dependencyTemplates.set(HarmonyAcceptDependency, new HarmonyAcceptDependency.Template());\n      compilation.dependencyFactories.set(HarmonyAcceptImportDependency, normalModuleFactory);\n      compilation.dependencyTemplates.set(HarmonyAcceptImportDependency, new HarmonyAcceptImportDependency.Template());\n\n      /**\n       * @param {Parser} parser parser parser\n       * @param {JavascriptParserOptions} parserOptions parserOptions\n       * @returns {void}\n       */\n      const handler = (parser, parserOptions) => {\n        // TODO webpack 6: rename harmony to esm or module\n        if (parserOptions.harmony !== undefined && !parserOptions.harmony) return;\n        new HarmonyDetectionParserPlugin(this.options).apply(parser);\n        new HarmonyImportDependencyParserPlugin(parserOptions).apply(parser);\n        new HarmonyExportDependencyParserPlugin(parserOptions).apply(parser);\n        new HarmonyTopLevelThisParserPlugin().apply(parser);\n      };\n      normalModuleFactory.hooks.parser.for(JAVASCRIPT_MODULE_TYPE_AUTO).tap(PLUGIN_NAME, handler);\n      normalModuleFactory.hooks.parser.for(JAVASCRIPT_MODULE_TYPE_ESM).tap(PLUGIN_NAME, handler);\n    });\n  }\n}\nmodule.exports = HarmonyModulesPlugin;","map":{"version":3,"names":["HarmonyAcceptDependency","require","HarmonyAcceptImportDependency","HarmonyCompatibilityDependency","HarmonyEvaluatedImportSpecifierDependency","HarmonyExportExpressionDependency","HarmonyExportHeaderDependency","HarmonyExportImportedSpecifierDependency","HarmonyExportSpecifierDependency","HarmonyImportSideEffectDependency","HarmonyImportSpecifierDependency","JAVASCRIPT_MODULE_TYPE_AUTO","JAVASCRIPT_MODULE_TYPE_ESM","HarmonyDetectionParserPlugin","HarmonyExportDependencyParserPlugin","HarmonyImportDependencyParserPlugin","HarmonyTopLevelThisParserPlugin","PLUGIN_NAME","HarmonyModulesPlugin","constructor","options","apply","compiler","hooks","compilation","tap","normalModuleFactory","dependencyTemplates","set","Template","dependencyFactories","handler","parser","parserOptions","harmony","undefined","for","module","exports"],"sources":["/Volumes/storage/projects/project-mcnt/node_modules/webpack/lib/dependencies/HarmonyModulesPlugin.js"],"sourcesContent":["/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\n\"use strict\";\n\nconst HarmonyAcceptDependency = require(\"./HarmonyAcceptDependency\");\nconst HarmonyAcceptImportDependency = require(\"./HarmonyAcceptImportDependency\");\nconst HarmonyCompatibilityDependency = require(\"./HarmonyCompatibilityDependency\");\nconst HarmonyEvaluatedImportSpecifierDependency = require(\"./HarmonyEvaluatedImportSpecifierDependency\");\nconst HarmonyExportExpressionDependency = require(\"./HarmonyExportExpressionDependency\");\nconst HarmonyExportHeaderDependency = require(\"./HarmonyExportHeaderDependency\");\nconst HarmonyExportImportedSpecifierDependency = require(\"./HarmonyExportImportedSpecifierDependency\");\nconst HarmonyExportSpecifierDependency = require(\"./HarmonyExportSpecifierDependency\");\nconst HarmonyImportSideEffectDependency = require(\"./HarmonyImportSideEffectDependency\");\nconst HarmonyImportSpecifierDependency = require(\"./HarmonyImportSpecifierDependency\");\n\nconst {\n\tJAVASCRIPT_MODULE_TYPE_AUTO,\n\tJAVASCRIPT_MODULE_TYPE_ESM\n} = require(\"../ModuleTypeConstants\");\nconst HarmonyDetectionParserPlugin = require(\"./HarmonyDetectionParserPlugin\");\nconst HarmonyExportDependencyParserPlugin = require(\"./HarmonyExportDependencyParserPlugin\");\nconst HarmonyImportDependencyParserPlugin = require(\"./HarmonyImportDependencyParserPlugin\");\nconst HarmonyTopLevelThisParserPlugin = require(\"./HarmonyTopLevelThisParserPlugin\");\n\n/** @typedef {import(\"../../declarations/WebpackOptions\").JavascriptParserOptions} JavascriptParserOptions */\n/** @typedef {import(\"../Compiler\")} Compiler */\n/** @typedef {import(\"../javascript/JavascriptParser\")} Parser */\n\nconst PLUGIN_NAME = \"HarmonyModulesPlugin\";\n\n/** @typedef {{ topLevelAwait?: boolean }} HarmonyModulesPluginOptions */\n\nclass HarmonyModulesPlugin {\n\t/**\n\t * @param {HarmonyModulesPluginOptions} options options\n\t */\n\tconstructor(options) {\n\t\tthis.options = options;\n\t}\n\n\t/**\n\t * Apply the plugin\n\t * @param {Compiler} compiler the compiler instance\n\t * @returns {void}\n\t */\n\tapply(compiler) {\n\t\tcompiler.hooks.compilation.tap(\n\t\t\tPLUGIN_NAME,\n\t\t\t(compilation, { normalModuleFactory }) => {\n\t\t\t\tcompilation.dependencyTemplates.set(\n\t\t\t\t\tHarmonyCompatibilityDependency,\n\t\t\t\t\tnew HarmonyCompatibilityDependency.Template()\n\t\t\t\t);\n\n\t\t\t\tcompilation.dependencyFactories.set(\n\t\t\t\t\tHarmonyImportSideEffectDependency,\n\t\t\t\t\tnormalModuleFactory\n\t\t\t\t);\n\t\t\t\tcompilation.dependencyTemplates.set(\n\t\t\t\t\tHarmonyImportSideEffectDependency,\n\t\t\t\t\tnew HarmonyImportSideEffectDependency.Template()\n\t\t\t\t);\n\n\t\t\t\tcompilation.dependencyFactories.set(\n\t\t\t\t\tHarmonyImportSpecifierDependency,\n\t\t\t\t\tnormalModuleFactory\n\t\t\t\t);\n\t\t\t\tcompilation.dependencyTemplates.set(\n\t\t\t\t\tHarmonyImportSpecifierDependency,\n\t\t\t\t\tnew HarmonyImportSpecifierDependency.Template()\n\t\t\t\t);\n\n\t\t\t\tcompilation.dependencyFactories.set(\n\t\t\t\t\tHarmonyEvaluatedImportSpecifierDependency,\n\t\t\t\t\tnormalModuleFactory\n\t\t\t\t);\n\t\t\t\tcompilation.dependencyTemplates.set(\n\t\t\t\t\tHarmonyEvaluatedImportSpecifierDependency,\n\t\t\t\t\tnew HarmonyEvaluatedImportSpecifierDependency.Template()\n\t\t\t\t);\n\n\t\t\t\tcompilation.dependencyTemplates.set(\n\t\t\t\t\tHarmonyExportHeaderDependency,\n\t\t\t\t\tnew HarmonyExportHeaderDependency.Template()\n\t\t\t\t);\n\n\t\t\t\tcompilation.dependencyTemplates.set(\n\t\t\t\t\tHarmonyExportExpressionDependency,\n\t\t\t\t\tnew HarmonyExportExpressionDependency.Template()\n\t\t\t\t);\n\n\t\t\t\tcompilation.dependencyTemplates.set(\n\t\t\t\t\tHarmonyExportSpecifierDependency,\n\t\t\t\t\tnew HarmonyExportSpecifierDependency.Template()\n\t\t\t\t);\n\n\t\t\t\tcompilation.dependencyFactories.set(\n\t\t\t\t\tHarmonyExportImportedSpecifierDependency,\n\t\t\t\t\tnormalModuleFactory\n\t\t\t\t);\n\t\t\t\tcompilation.dependencyTemplates.set(\n\t\t\t\t\tHarmonyExportImportedSpecifierDependency,\n\t\t\t\t\tnew HarmonyExportImportedSpecifierDependency.Template()\n\t\t\t\t);\n\n\t\t\t\tcompilation.dependencyTemplates.set(\n\t\t\t\t\tHarmonyAcceptDependency,\n\t\t\t\t\tnew HarmonyAcceptDependency.Template()\n\t\t\t\t);\n\n\t\t\t\tcompilation.dependencyFactories.set(\n\t\t\t\t\tHarmonyAcceptImportDependency,\n\t\t\t\t\tnormalModuleFactory\n\t\t\t\t);\n\t\t\t\tcompilation.dependencyTemplates.set(\n\t\t\t\t\tHarmonyAcceptImportDependency,\n\t\t\t\t\tnew HarmonyAcceptImportDependency.Template()\n\t\t\t\t);\n\n\t\t\t\t/**\n\t\t\t\t * @param {Parser} parser parser parser\n\t\t\t\t * @param {JavascriptParserOptions} parserOptions parserOptions\n\t\t\t\t * @returns {void}\n\t\t\t\t */\n\t\t\t\tconst handler = (parser, parserOptions) => {\n\t\t\t\t\t// TODO webpack 6: rename harmony to esm or module\n\t\t\t\t\tif (parserOptions.harmony !== undefined && !parserOptions.harmony)\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\tnew HarmonyDetectionParserPlugin(this.options).apply(parser);\n\t\t\t\t\tnew HarmonyImportDependencyParserPlugin(parserOptions).apply(parser);\n\t\t\t\t\tnew HarmonyExportDependencyParserPlugin(parserOptions).apply(parser);\n\t\t\t\t\tnew HarmonyTopLevelThisParserPlugin().apply(parser);\n\t\t\t\t};\n\n\t\t\t\tnormalModuleFactory.hooks.parser\n\t\t\t\t\t.for(JAVASCRIPT_MODULE_TYPE_AUTO)\n\t\t\t\t\t.tap(PLUGIN_NAME, handler);\n\t\t\t\tnormalModuleFactory.hooks.parser\n\t\t\t\t\t.for(JAVASCRIPT_MODULE_TYPE_ESM)\n\t\t\t\t\t.tap(PLUGIN_NAME, handler);\n\t\t\t}\n\t\t);\n\t}\n}\nmodule.exports = HarmonyModulesPlugin;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}
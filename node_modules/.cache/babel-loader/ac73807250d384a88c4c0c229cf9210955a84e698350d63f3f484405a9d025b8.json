{"ast":null,"code":"/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra and Zackary Jackson @ScriptedAlchemy\n*/\n\n\"use strict\";\n\nconst {\n  RawSource\n} = require(\"webpack-sources\");\nconst Module = require(\"../Module\");\nconst {\n  WEBPACK_MODULE_TYPE_REMOTE\n} = require(\"../ModuleTypeConstants\");\nconst RuntimeGlobals = require(\"../RuntimeGlobals\");\nconst makeSerializable = require(\"../util/makeSerializable\");\nconst FallbackDependency = require(\"./FallbackDependency\");\nconst RemoteToExternalDependency = require(\"./RemoteToExternalDependency\");\n\n/** @typedef {import(\"../../declarations/WebpackOptions\").WebpackOptionsNormalized} WebpackOptions */\n/** @typedef {import(\"../ChunkGraph\")} ChunkGraph */\n/** @typedef {import(\"../ChunkGroup\")} ChunkGroup */\n/** @typedef {import(\"../Compilation\")} Compilation */\n/** @typedef {import(\"../Module\").CodeGenerationContext} CodeGenerationContext */\n/** @typedef {import(\"../Module\").CodeGenerationResult} CodeGenerationResult */\n/** @typedef {import(\"../Module\").LibIdentOptions} LibIdentOptions */\n/** @typedef {import(\"../Module\").NeedBuildContext} NeedBuildContext */\n/** @typedef {import(\"../Module\").SourceTypes} SourceTypes */\n/** @typedef {import(\"../RequestShortener\")} RequestShortener */\n/** @typedef {import(\"../ResolverFactory\").ResolverWithOptions} ResolverWithOptions */\n/** @typedef {import(\"../WebpackError\")} WebpackError */\n/** @typedef {import(\"../serialization/ObjectMiddleware\").ObjectDeserializerContext} ObjectDeserializerContext */\n/** @typedef {import(\"../serialization/ObjectMiddleware\").ObjectSerializerContext} ObjectSerializerContext */\n/** @typedef {import(\"../util/Hash\")} Hash */\n/** @typedef {import(\"../util/fs\").InputFileSystem} InputFileSystem */\n\nconst TYPES = new Set([\"remote\", \"share-init\"]);\nconst RUNTIME_REQUIREMENTS = new Set([RuntimeGlobals.module]);\nclass RemoteModule extends Module {\n  /**\n   * @param {string} request request string\n   * @param {string[]} externalRequests list of external requests to containers\n   * @param {string} internalRequest name of exposed module in container\n   * @param {string} shareScope the used share scope name\n   */\n  constructor(request, externalRequests, internalRequest, shareScope) {\n    super(WEBPACK_MODULE_TYPE_REMOTE);\n    this.request = request;\n    this.externalRequests = externalRequests;\n    this.internalRequest = internalRequest;\n    this.shareScope = shareScope;\n    this._identifier = `remote (${shareScope}) ${this.externalRequests.join(\" \")} ${this.internalRequest}`;\n  }\n\n  /**\n   * @returns {string} a unique identifier of the module\n   */\n  identifier() {\n    return this._identifier;\n  }\n\n  /**\n   * @param {RequestShortener} requestShortener the request shortener\n   * @returns {string} a user readable identifier of the module\n   */\n  readableIdentifier(requestShortener) {\n    return `remote ${this.request}`;\n  }\n\n  /**\n   * @param {LibIdentOptions} options options\n   * @returns {string | null} an identifier for library inclusion\n   */\n  libIdent(options) {\n    return `${this.layer ? `(${this.layer})/` : \"\"}webpack/container/remote/${this.request}`;\n  }\n\n  /**\n   * @param {NeedBuildContext} context context info\n   * @param {function((WebpackError | null)=, boolean=): void} callback callback function, returns true, if the module needs a rebuild\n   * @returns {void}\n   */\n  needBuild(context, callback) {\n    callback(null, !this.buildInfo);\n  }\n\n  /**\n   * @param {WebpackOptions} options webpack options\n   * @param {Compilation} compilation the compilation\n   * @param {ResolverWithOptions} resolver the resolver\n   * @param {InputFileSystem} fs the file system\n   * @param {function(WebpackError=): void} callback callback function\n   * @returns {void}\n   */\n  build(options, compilation, resolver, fs, callback) {\n    this.buildMeta = {};\n    this.buildInfo = {\n      strict: true\n    };\n    this.clearDependenciesAndBlocks();\n    if (this.externalRequests.length === 1) {\n      this.addDependency(new RemoteToExternalDependency(this.externalRequests[0]));\n    } else {\n      this.addDependency(new FallbackDependency(this.externalRequests));\n    }\n    callback();\n  }\n\n  /**\n   * @param {string=} type the source type for which the size should be estimated\n   * @returns {number} the estimated size of the module (must be non-zero)\n   */\n  size(type) {\n    return 6;\n  }\n\n  /**\n   * @returns {SourceTypes} types available (do not mutate)\n   */\n  getSourceTypes() {\n    return TYPES;\n  }\n\n  /**\n   * @returns {string | null} absolute path which should be used for condition matching (usually the resource path)\n   */\n  nameForCondition() {\n    return this.request;\n  }\n\n  /**\n   * @param {CodeGenerationContext} context context for code generation\n   * @returns {CodeGenerationResult} result\n   */\n  codeGeneration({\n    runtimeTemplate,\n    moduleGraph,\n    chunkGraph\n  }) {\n    const module = moduleGraph.getModule(this.dependencies[0]);\n    const id = module && chunkGraph.getModuleId(module);\n    const sources = new Map();\n    sources.set(\"remote\", new RawSource(\"\"));\n    const data = new Map();\n    data.set(\"share-init\", [{\n      shareScope: this.shareScope,\n      initStage: 20,\n      init: id === undefined ? \"\" : `initExternal(${JSON.stringify(id)});`\n    }]);\n    return {\n      sources,\n      data,\n      runtimeRequirements: RUNTIME_REQUIREMENTS\n    };\n  }\n\n  /**\n   * @param {ObjectSerializerContext} context context\n   */\n  serialize(context) {\n    const {\n      write\n    } = context;\n    write(this.request);\n    write(this.externalRequests);\n    write(this.internalRequest);\n    write(this.shareScope);\n    super.serialize(context);\n  }\n\n  /**\n   * @param {ObjectDeserializerContext} context context\n   * @returns {RemoteModule} deserialized module\n   */\n  static deserialize(context) {\n    const {\n      read\n    } = context;\n    const obj = new RemoteModule(read(), read(), read(), read());\n    obj.deserialize(context);\n    return obj;\n  }\n}\nmakeSerializable(RemoteModule, \"webpack/lib/container/RemoteModule\");\nmodule.exports = RemoteModule;","map":{"version":3,"names":["RawSource","require","Module","WEBPACK_MODULE_TYPE_REMOTE","RuntimeGlobals","makeSerializable","FallbackDependency","RemoteToExternalDependency","TYPES","Set","RUNTIME_REQUIREMENTS","module","RemoteModule","constructor","request","externalRequests","internalRequest","shareScope","_identifier","join","identifier","readableIdentifier","requestShortener","libIdent","options","layer","needBuild","context","callback","buildInfo","build","compilation","resolver","fs","buildMeta","strict","clearDependenciesAndBlocks","length","addDependency","size","type","getSourceTypes","nameForCondition","codeGeneration","runtimeTemplate","moduleGraph","chunkGraph","getModule","dependencies","id","getModuleId","sources","Map","set","data","initStage","init","undefined","JSON","stringify","runtimeRequirements","serialize","write","deserialize","read","obj","exports"],"sources":["/Volumes/storage/projects/project-mcnt/node_modules/webpack/lib/container/RemoteModule.js"],"sourcesContent":["/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra and Zackary Jackson @ScriptedAlchemy\n*/\n\n\"use strict\";\n\nconst { RawSource } = require(\"webpack-sources\");\nconst Module = require(\"../Module\");\nconst { WEBPACK_MODULE_TYPE_REMOTE } = require(\"../ModuleTypeConstants\");\nconst RuntimeGlobals = require(\"../RuntimeGlobals\");\nconst makeSerializable = require(\"../util/makeSerializable\");\nconst FallbackDependency = require(\"./FallbackDependency\");\nconst RemoteToExternalDependency = require(\"./RemoteToExternalDependency\");\n\n/** @typedef {import(\"../../declarations/WebpackOptions\").WebpackOptionsNormalized} WebpackOptions */\n/** @typedef {import(\"../ChunkGraph\")} ChunkGraph */\n/** @typedef {import(\"../ChunkGroup\")} ChunkGroup */\n/** @typedef {import(\"../Compilation\")} Compilation */\n/** @typedef {import(\"../Module\").CodeGenerationContext} CodeGenerationContext */\n/** @typedef {import(\"../Module\").CodeGenerationResult} CodeGenerationResult */\n/** @typedef {import(\"../Module\").LibIdentOptions} LibIdentOptions */\n/** @typedef {import(\"../Module\").NeedBuildContext} NeedBuildContext */\n/** @typedef {import(\"../Module\").SourceTypes} SourceTypes */\n/** @typedef {import(\"../RequestShortener\")} RequestShortener */\n/** @typedef {import(\"../ResolverFactory\").ResolverWithOptions} ResolverWithOptions */\n/** @typedef {import(\"../WebpackError\")} WebpackError */\n/** @typedef {import(\"../serialization/ObjectMiddleware\").ObjectDeserializerContext} ObjectDeserializerContext */\n/** @typedef {import(\"../serialization/ObjectMiddleware\").ObjectSerializerContext} ObjectSerializerContext */\n/** @typedef {import(\"../util/Hash\")} Hash */\n/** @typedef {import(\"../util/fs\").InputFileSystem} InputFileSystem */\n\nconst TYPES = new Set([\"remote\", \"share-init\"]);\nconst RUNTIME_REQUIREMENTS = new Set([RuntimeGlobals.module]);\n\nclass RemoteModule extends Module {\n\t/**\n\t * @param {string} request request string\n\t * @param {string[]} externalRequests list of external requests to containers\n\t * @param {string} internalRequest name of exposed module in container\n\t * @param {string} shareScope the used share scope name\n\t */\n\tconstructor(request, externalRequests, internalRequest, shareScope) {\n\t\tsuper(WEBPACK_MODULE_TYPE_REMOTE);\n\t\tthis.request = request;\n\t\tthis.externalRequests = externalRequests;\n\t\tthis.internalRequest = internalRequest;\n\t\tthis.shareScope = shareScope;\n\t\tthis._identifier = `remote (${shareScope}) ${this.externalRequests.join(\n\t\t\t\" \"\n\t\t)} ${this.internalRequest}`;\n\t}\n\n\t/**\n\t * @returns {string} a unique identifier of the module\n\t */\n\tidentifier() {\n\t\treturn this._identifier;\n\t}\n\n\t/**\n\t * @param {RequestShortener} requestShortener the request shortener\n\t * @returns {string} a user readable identifier of the module\n\t */\n\treadableIdentifier(requestShortener) {\n\t\treturn `remote ${this.request}`;\n\t}\n\n\t/**\n\t * @param {LibIdentOptions} options options\n\t * @returns {string | null} an identifier for library inclusion\n\t */\n\tlibIdent(options) {\n\t\treturn `${this.layer ? `(${this.layer})/` : \"\"}webpack/container/remote/${\n\t\t\tthis.request\n\t\t}`;\n\t}\n\n\t/**\n\t * @param {NeedBuildContext} context context info\n\t * @param {function((WebpackError | null)=, boolean=): void} callback callback function, returns true, if the module needs a rebuild\n\t * @returns {void}\n\t */\n\tneedBuild(context, callback) {\n\t\tcallback(null, !this.buildInfo);\n\t}\n\n\t/**\n\t * @param {WebpackOptions} options webpack options\n\t * @param {Compilation} compilation the compilation\n\t * @param {ResolverWithOptions} resolver the resolver\n\t * @param {InputFileSystem} fs the file system\n\t * @param {function(WebpackError=): void} callback callback function\n\t * @returns {void}\n\t */\n\tbuild(options, compilation, resolver, fs, callback) {\n\t\tthis.buildMeta = {};\n\t\tthis.buildInfo = {\n\t\t\tstrict: true\n\t\t};\n\n\t\tthis.clearDependenciesAndBlocks();\n\t\tif (this.externalRequests.length === 1) {\n\t\t\tthis.addDependency(\n\t\t\t\tnew RemoteToExternalDependency(this.externalRequests[0])\n\t\t\t);\n\t\t} else {\n\t\t\tthis.addDependency(new FallbackDependency(this.externalRequests));\n\t\t}\n\n\t\tcallback();\n\t}\n\n\t/**\n\t * @param {string=} type the source type for which the size should be estimated\n\t * @returns {number} the estimated size of the module (must be non-zero)\n\t */\n\tsize(type) {\n\t\treturn 6;\n\t}\n\n\t/**\n\t * @returns {SourceTypes} types available (do not mutate)\n\t */\n\tgetSourceTypes() {\n\t\treturn TYPES;\n\t}\n\n\t/**\n\t * @returns {string | null} absolute path which should be used for condition matching (usually the resource path)\n\t */\n\tnameForCondition() {\n\t\treturn this.request;\n\t}\n\n\t/**\n\t * @param {CodeGenerationContext} context context for code generation\n\t * @returns {CodeGenerationResult} result\n\t */\n\tcodeGeneration({ runtimeTemplate, moduleGraph, chunkGraph }) {\n\t\tconst module = moduleGraph.getModule(this.dependencies[0]);\n\t\tconst id = module && chunkGraph.getModuleId(module);\n\t\tconst sources = new Map();\n\t\tsources.set(\"remote\", new RawSource(\"\"));\n\t\tconst data = new Map();\n\t\tdata.set(\"share-init\", [\n\t\t\t{\n\t\t\t\tshareScope: this.shareScope,\n\t\t\t\tinitStage: 20,\n\t\t\t\tinit: id === undefined ? \"\" : `initExternal(${JSON.stringify(id)});`\n\t\t\t}\n\t\t]);\n\t\treturn { sources, data, runtimeRequirements: RUNTIME_REQUIREMENTS };\n\t}\n\n\t/**\n\t * @param {ObjectSerializerContext} context context\n\t */\n\tserialize(context) {\n\t\tconst { write } = context;\n\t\twrite(this.request);\n\t\twrite(this.externalRequests);\n\t\twrite(this.internalRequest);\n\t\twrite(this.shareScope);\n\t\tsuper.serialize(context);\n\t}\n\n\t/**\n\t * @param {ObjectDeserializerContext} context context\n\t * @returns {RemoteModule} deserialized module\n\t */\n\tstatic deserialize(context) {\n\t\tconst { read } = context;\n\t\tconst obj = new RemoteModule(read(), read(), read(), read());\n\t\tobj.deserialize(context);\n\t\treturn obj;\n\t}\n}\n\nmakeSerializable(RemoteModule, \"webpack/lib/container/RemoteModule\");\n\nmodule.exports = RemoteModule;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}